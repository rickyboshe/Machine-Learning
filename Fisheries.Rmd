---
title: ""
output:
  html_document:
    collapsed: false
    number_sections: false
    toc_depth: 1
    #code_folding: hide
---
#  Seafood: The Ultimate Food `r emo::ji("fish")`?

As more people are opting against red meat diet for plant based and sea food, this might be a good time to analyze aquatic food sources. The [environmental impact](https://www.greenpeace.org.uk/news/why-meat-is-bad-for-the-environment/#:~:text=It%20causes%20climate%20change,the%20atmosphere%2C%20accelerating%20global%20warming) of industrialized red meat production and [health concerns](https://www.nytimes.com/2019/09/30/health/red-meat-heart-cancer.html) has made sea food a favourable alternative diet also termed as ["pescatarian diet"](https://www.medicalnewstoday.com/articles/323907#:~:text=What%20is%20a%20pescatarian%20diet%3F&text=In%20the%20pescatarian%20diet%2C%20a,and%20fish%20products%20may%20enhance). 

This project looks to answer two thing:

1.  Is seafood environmentally sustainable? 
2.  Does it pack the nutrients to replace red meat diet?



```{r setup, include=FALSE, results='hide', message=FALSE, warning=FALSE}
#Loading packages
library(tidyverse)
library(ggplot2)
library(dplyr)
library(corrplot)
library(plotly)
library(ggcorrplot)
library(jsonlite)
library(httr)
library(scales)
devtools::install_github("hadley/emo")

```

We shall be utilizing the fisheries management dataset from the [National Oceanic and Atmostpheric Administration (NOAA)](https://www.fishwatch.gov/resources). Accessing the latest data using their **FishWatch API**.

This is my first time attempting to work with APIs to access data. A learning curve. 

### Acessing the data
```{r data, include=TRUE, warning=FALSE, message=FALSE}
#Create a function to request the endpoint and receive a dataframe converted from JSON

fish<- function(endpoint) {
  url <- modify_url("https://www.fishwatch.gov", path = endpoint)
  response<-GET(url)
  
  #tracking status codes
  if(http_error(response)){
    print(status_code(response))
    stop("Something went wrong.", call. = FALSE)
  }
  
  if(http_type(response)!="application/json"){
    stop("API did not return json", call. = FALSE)
  }
  #Get content as text
  json_text<- content(response, as="text")
  dataframe<-fromJSON(json_text)
  return(dataframe)
  
}

fish.df<-as_tibble(flatten(fish("/api/species?format=json")))

#Remain with variables useful in the analysis
fish.df<-fish.df%>%
  select(2,7,8,12,14,17:19,26,29,32,33,36,41,45:47,
        49,51,56)
var_name<-data.frame(names(fish.df))
var_name<-var_name%>%
  rename(Variables=names.fish.df.)

  
```

We have reduced it to the essential variables we shall use to evaluate some of the sea food being monitored by NOAA. 


```{r clean, include=TRUE, warning=FALSE, message=FALSE}
#The data contains html tags throughout the columns. Clean them out
cleanFun <- function(htmlString) {
  return(gsub("<.*?>", "", htmlString))
}
fish.df<-data.frame(map(fish.df, cleanFun))


```


### Data Cleaning and Manipulation
```{r pop, include=TRUE, warning=FALSE, message=FALSE}
#Categorize population(naive categorization using the first instance of the words "Above", "Unknown" and "Below")
fish.df<-fish.df%>%
  mutate(population=ifelse(str_detect(Population, "[Aa]bove"), "Above target", 
                    ifelse(str_detect(Population, "[Uu]nknown"), "Unknown",
                           ifelse(str_detect(Population, "[Bb]elow|Near"),"Below target", NA))))    


```

```{r df1, echo=FALSE}
Fish_Population<-data.frame(table(fish.df$pop))
Fish_Population<-Fish_Population%>%
  rename(Population=Var1)%>%
  rename(Species=Freq)
Fish_Population

```


```{r availability, include=TRUE, warning=FALSE, message=FALSE}
#Categorize their availability (Annual or seasonal)
fish.df<-fish.df%>%
  mutate(availability=ifelse(str_detect(Availability, "[Yy]ear-?round"), "Year round", "Seasonal"))    

```

```{r df2, echo=FALSE}

Fish_Availability<-data.frame(table(fish.df$availability))
Fish_Availability<-Fish_Availability%>%
  rename(Availability=Var1)%>%
  rename(Species=Freq)
Fish_Availability

```

For fish that are caught fresh in long periods of the year i.e. 6-8 months of the year, and are canned or frozen year long, are coded as available **year-round**. 


Fish that are caught on strict seasonal basis e.g. June to October, together with fish that are sporadically caught i.e. Wreckfish, are categorized as **seasonal**.


```{r rate, include=TRUE, warning=FALSE, message=FALSE}
#Categorize the fishing rates
##regex to capture overfishing
rate_regex="i?(closed|prohibited|[Rr]educe(d)?|quota|(rates))"
fish.df<-fish.df%>%
  mutate(fishing_rate=ifelse(str_detect(Fishing.Rate, "[Rr]ecommended|Not"), "Stable",
                             ifelse(str_detect(Fishing.Rate,rate_regex),"Over", "Unknown"))) 

```

```{r df3, echo=FALSE}
Fish_rate<-data.frame(table(fish.df$fishing_rate))
Fish_rate<-Fish_rate%>%
  rename("Fishing rate"=Var1)%>%
  rename(Species=Freq)
Fish_rate

```

How the fishing rates were coded:


1.  **Over**: This include species are experiencing a mandated reduced fishing, species that are in regions where authorities have implemented quotas or rates to protect populations or fishing is out-right closed. e.g Sardines
2.  **Stable**: This include species that that are being fished at "recommended levels" within the fishing regions during the compilation of this data. e.g. Lobster
3.  **Unknown**: This single observation is for the **California Market Squid** whose fishing rate and populations have not be estimated by NOAA.


```{r Env, include=TRUE, warning=FALSE, message=FALSE}
#Categorize the environmental impact of species
fish.df<-fish.df%>%
  mutate(env_effects=ifelse(str_detect(Environmental.Effects, "benefits"), "Net benefit",
                            ifelse(str_detect(Environmental.Effects, "state"), 
                                   "Federal monitoring","Unknown"))) 

```

```{r df4, echo=FALSE}

Fish_env<-data.frame(table(fish.df$env_effects))
Fish_env<-Fish_env%>%
  rename("Environmental Effects"= Var1)%>%
  rename(Species=Freq)
Fish_env

```

Unfortunately, not all species have their environmental effects recorded. Oysters, Mussels, Clams and Geoducks have been quoted to have a "**net benefit** on the environment as they remove excess nutrients and improve water quality". Sugar kelp have the same benefits with the additional carbon fixing where they turn carbon-dioxide into oxygen. 

The Atlantic Salmon and Sablefish are being actively monitored by the federal and state authorities to ensure their fishing have minimal impact on the environment. 


####  Fish Nutrition
```{r nutrition, include=TRUE, warning=FALSE, message=FALSE}
#Convert the columns to numeric and rename to carry their respective units
#Calories column to numeric 
fish.df$Calories<-parse_number(fish.df$Calories) 

#Carbohydrates
fish.df$Carbohydrate<-parse_number(fish.df$Carbohydrate) 
fish.df<-fish.df%>%
  rename("carbs (g/ser)" = Carbohydrate)

#Cholesterol
fish.df$Cholesterol<-parse_number(fish.df$Cholesterol) 
fish.df<-fish.df%>%
  rename("cholesterol (mg/ser)" = Cholesterol)

#Fat
fish.df$Fat..Total<-parse_number(fish.df$Fat..Total) 
fish.df<-fish.df%>%
  rename("fat (g/ser)" = Fat..Total)

#Fiber
##This column has one value in mg and the rest are in g
unique(fish.df$Fiber..Total.Dietary)
fish.df$Fiber..Total.Dietary<-parse_number(fish.df$Fiber..Total.Dietary)

##convert the mg value to g
fish.df$Fiber..Total.Dietary<-ifelse(fish.df$Fiber..Total.Dietary==34, 34/1000, fish.df$Fiber..Total.Dietary)
fish.df$Fiber..Total.Dietary<-round(fish.df$Fiber..Total.Dietary, 2)

fish.df<-fish.df%>%
  rename("fiber (g/ser)" = Fiber..Total.Dietary)

#Protein
fish.df$Protein <-parse_number(fish.df$Protein) 
fish.df<-fish.df%>%
  rename("protein (g/ser)" = Protein)

#Saturated fat
fish.df$Saturated.Fatty.Acids..Total <-parse_number(fish.df$Saturated.Fatty.Acids..Total )
fish.df$Saturated.Fatty.Acids..Total<-round(fish.df$Saturated.Fatty.Acids..Total, 2)
fish.df<-fish.df%>%
  rename("saturated fatty acids (g/ser)" = Saturated.Fatty.Acids..Total)

#Selenium
##Some values are in percentage of daily intake and some in mcg
unique(fish.df$Selenium)
fish.df$Selenium <-parse_number(fish.df$Selenium) 
fish.df$Selenium<-ifelse(fish.df$Selenium==160, 55*1.6, fish.df$Selenium) #55 mcg is the USA daily intake for adults and children above 14.

fish.df<-fish.df%>%
  rename("selenium (mcg/ser)" = Selenium)

#Sodium
fish.df$Sodium <-parse_number(fish.df$Sodium) 
fish.df<-fish.df%>%
  rename("sodium (mg/ser)" = Sodium)

#Sugars
fish.df$Sugars..Total <-parse_number(fish.df$Sugars..Total) 
fish.df<-fish.df%>%
  rename("sugars (g/ser)" = Sugars..Total)

#Serving Weight
fish.df$Serving.Weight <-parse_number(fish.df$Serving.Weight) 
fish.df<-fish.df%>%
  rename("serving weights (g)" = Serving.Weight)


```

```{r mutate, include=FALSE}

#remove redundant columns
fish.df<-fish.df%>%
  select(-Habitat, -Population, -Availability, -Environmental.Effects)

#lower case column names
fish.df<-fish.df%>%
  rename_with(str_to_lower)%>%
  rename(species=species.name)
```


### Regional Fishing

```{r region, include=TRUE, fig.height= 5, fig.width= 10, results="hide" }
fig1<-fish.df%>%ggplot(aes(x=noaa.fisheries.region, fill=noaa.fisheries.region))+
  geom_bar()+
  theme_minimal()+
  theme(plot.title = element_text(color="black", size=14, face="bold",hjust = 0.5),
        axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        legend.title = element_blank(),
        axis.title.x = element_text(color="black", size=12, face="bold"),
        axis.title.y = element_text(color="black", size=12, face="bold"))+
  scale_y_continuous(expand = c(0, 0))+
  labs(title = "Distribution of fish species within \nNOAA fisheries regions",
       x="Region",
       y="No of Species")

mrg <- list(l = 10, r = 40,
          b = 15, t = 100,
          pad = 0)

fig1<-ggplotly(fig1)%>%layout(margin=mrg)

```

```{r fig2, include=TRUE, fig.height= 5, fig.width= 10, fig.align="center", echo=FALSE }
#Plotly to make the chart more interactive
fig1<- ggplotly(fig1)%>% add_annotations( text="NOAA Fishery Region", 
                                          xref="paper", yref="paper",
                                          x=1.02, xanchor="left",
                                          y=0.9, yanchor="bottom", 
                                          legendtitle=TRUE, showarrow=FALSE ) %>%
  layout( legend=list(y=0.9, yanchor="top" ) )

fig1

```
<br></br>
The most species are found in the Greater Atlantic area while the least are found in the Pacific Island fishery region.

This means chances are, most of the fish people consume in the US comes from the Greater Atlantic area! But does this mean the region is subject to over fishing?



### Regional Fishing Rates
We can examine how the fishing rates are in every region in the US. The goal is to identify regions that are experiencing over fishing or are within recommended fishing levels.

```{r env, Include=TRUE, fig.height= 7.5, fig.width= 10, fig.align="center", message=FALSE, warning=FALSE}
#Availability vs Fishing rate
plotdata <- fish.df%>%
  drop_na(fishing_rate)%>%
  group_by(noaa.fisheries.region, fishing_rate)%>%
  summarize(n = n())%>% 
  mutate(pct = n/sum(n),
         lbl = scales::percent(pct))

fig2<-plotdata%>%
  ggplot(aes(x=noaa.fisheries.region, y=pct, fill=fishing_rate))+
  geom_bar(stat = "identity", position = "fill")+
  theme_minimal()+
  theme(plot.title = element_text(color="black", size=14, face="bold",hjust = 0.5),
        axis.ticks = element_blank(),
        legend.title = element_blank(),
        axis.title.x = element_text(color="black", size=12, face="bold"),
        axis.title.y = element_text(color="black", size=12, face="bold"))+
  scale_y_continuous(breaks = seq(0, 1, .2),label = percent)+
  geom_text(aes(label = lbl), size = 3, 
            position = position_stack(vjust = 0.5))+
  labs(title = "Fishing Rate by Fishing Region",
       x="",
       y="Percent")

#Plotly to make the chart more interactive
fig2<- ggplotly(fig2)%>% add_annotations( text="Fishing Rate", 
                                            xref="paper", yref="paper",
                                            x=1.02, xanchor="left",
                                            y=0.9, yanchor="bottom",
                                            legendtitle=TRUE, showarrow=FALSE )%>%
  layout(legend=list(y=0.9, yanchor="top"),xaxis=list(tickangle=-45))%>%
  style(hoverinfo = 'none')

fig2
```

The majority of fishing regions are experiencing stable fishing rates, well within recommended levels for existing populations. The Greater Atlantic fishing zone has the highest levels of over fishing as compared to the other regions (20%).

<br></br>

| Blue Mussel  | Sable Fish |
| :-----------: | :-----------: |
| <img src="https://www.fishwatch.gov/sites/default/files/blue_mussel.png" alt="blue mussel" width="300" height="150"/>  | <img align="center" src="https://www.fishwatch.gov/sites/default/files/sablefish.png" alt="sable fish" width="400" height="100"/> |
| The blue mussel has been observed to have a net benefit on the environment while boasting rich levels of protein (21% RDA). | The sable fish is available year round and is a great source for protein (24% RDA), low on carbs (0% RDA) and sodium (4% RDA). But the species is under monitoring from federal and state authorities to ensure its fishing has minimal impact on the environment. It also has relatively high levels of selenium (66% RDA). |


###  How nutritious is seafood?

```{r seafood, include=TRUE, warning=FALSE, message=FALSE}
#Using the RDA information from US Dietary guidelines. 
#a) Dietary guidelines as a percentage of food calories
fish.df<-fish.df%>%
  mutate(fat_RDA=`fat (g/ser)`*100/93,
         s.fat_RDA=`saturated fatty acids (g/ser)`*100/13,
         carbs_RDA=`carbs (g/ser)`*100/130,
         sugars_RDA=`sugars (g/ser)`*100/25,
         protein_RDA=`protein (g/ser)`*100/56,
         cholesterol_RDA=`cholesterol (mg/ser)`*100/300,
         fiber_RDA=`fiber (g/ser)`*100/30,
         sodium_RDA=`sodium (mg/ser)`*100/1300,
         selenium_RDA=`selenium (mcg/ser)`*100/55)

fish.df<-fish.df %>% 
  mutate_at(vars(ends_with("RDA")), funs(round(., 2)))
```


```{r fig3, include=FALSE, fig.height= 7.5, fig.width= 9, fig.align="center", warning=FALSE, message=FALSE}

fish_longer<-fish.df%>%
  pivot_longer(cols = c(fat_RDA, s.fat_RDA, carbs_RDA, sugars_RDA, protein_RDA,
                        cholesterol_RDA, fiber_RDA, sodium_RDA, selenium_RDA),
               names_to="nutrient",
               values_to="percent")

fig3<-fish_longer%>%ggplot(aes(x=nutrient, y=percent, color=nutrient))+
  geom_boxplot()+
  theme(plot.title = element_text(color="black", size=14, face="bold",hjust = 0.5),
        axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        legend.title = element_blank(),
        axis.title.x = element_text(color="black", size=12),
        axis.title.y = element_text(color="black", size=12))+
  labs(title="Fish calories and nutritional values \n(percentage RDA)",
       x= "Nutrient",
       y= "Percentage RDA")+
  scale_color_discrete(labels = c("Fat RDA", "Saturated Fatty Acids RDA", 
                                  "Carbohydrate RDA","Sugars RDA","Protein RDA", 
                                  "Cholesterol RDA", "Dietary Fiber RDA", 
                                  "Sodium RDA", "Selenium RDA"))
fig3
```

```{r fig4, include=TRUE, fig.height= 7.5, fig.width= 9, fig.align="center", message=FALSE, warning=FALSE}

fig4<-plot_ly(data = fish_longer, x=~nutrient, y =~percent, color =~nutrient, 
        type = "box", textposition = "auto", hoverinfo = "text",
        hovertext = paste("Species :", fish_longer$species.name,"<br> RDA :", 
                          fish_longer$percent))%>% 
  layout(title="<b>Fish calories and nutritional values \n(percentage RDA)<b>",
         xaxis = list(title='',
                      ticktext = list("Fat", "Saturated Fatty Acids", "Carbohydrate",
                                      "Sugars","Protein", "Cholesterol", 
                                      "Dietary Fiber", "Sodium", "Selenium"), 
      tickvals = list("fat_RDA", "s.fat_RDA", "carbs_RDA", "sugars_RDA", "protein_RDA",
                      "cholesterol_RDA", "fiber_RDA", "sodium_RDA", "selenium_RDA"),
      tickangle = -45),
      yaxis = list(title='Percentage RDA'))%>%
  hide_legend()
fig4


```


It looks like most fish species are rich in protein, selenium and cholesterol. With the exception of Atlantic Bigeye Tuna and Pacific Blue Marin, all fish species have nutrients that are within the recommended dietary allowance in the USA. 

All species show very low amounts of sugars, fat and saturated fatty acids, which is good for heart health. For anyone looking for a low carb diet, fish is the answer. They have very low carbohydrate per serving. 

```{r fig5, include=FALSE, fig.height= 7.5, fig.width= 9, fig.align="center", message=FALSE, warning=FALSE }
#Plotly to make the chart more interactive
fig5<- ggplotly(fig3)%>%
  add_annotations( text="Nutrition", xref="paper", yref="paper",
                  x=1.02, xanchor="left",
                  y=0.9, yanchor="bottom",    # Same y as legend below
                  legendtitle=TRUE, showarrow=FALSE ) %>%
  layout(legend=list(y=0.9, yanchor="top"),
         margin=mrg)
fig5

```

```{r quad, Include=TRUE, fig.height= 7.5, fig.width= 9, fig.align="center", message=FALSE, warning=FALSE}

#Trend of fish calories and their nutrients
nut.labs<-c("Fat", "Saturated Fatty Acids", "Carbohydrate", "Sugars",
            "Protein", "Cholesterol", "Dietary Fiber", "Sodium", "Selenium")
names(nut.labs)<-c("fat_RDA", "s.fat_RDA", "carbs_RDA", "sugars_RDA", "protein_RDA",
                    "cholesterol_RDA", "fiber_RDA", "sodium_RDA", "selenium_RDA")

fig6<-fish_longer%>%ggplot(aes(x=calories, y=percent, color=nutrient, group=species))+
  geom_point(shape=1)+
  theme_minimal()+
  theme(plot.title = element_text(color="black", size=14, face="bold",hjust = 0.5),
        legend.title = element_blank(),
        axis.title.x = element_text(color="black", size=12),
        axis.title.y = element_text(color="black", size=12),
        panel.spacing.y = unit(1, "lines"))+
    labs(title="Relationship between Calories and Nutrients",
       x= "Calories",
       y= "Percentage RDA")+
  facet_wrap(~nutrient, labeller = labeller(nutrient=nut.labs),
             scales="free_y")

mrg2 <- list(l = 10, r = 40,
          b = 10, t = 100,
          pad = 0)

fig6<- ggplotly(fig6, tooltip = c("species"))%>%
  layout(margin=mrg2)%>%
  hide_legend()

fig6

```


It would appear that the calories of fish have weak negative relationship with the amount of carbohydrates and sugars. While there is no significant relationship between fish calories with dietary fibers, cholesterol and selenium. But there is a strong relationship between fish calories and Fat (r = 0.91), Saturated fat (r = 0.90) and Protein (r = 0.39). 

So for people trying to avoid fat and saturated fatty acids, fish might not be the ideal dish for you. 


```{r mat, include=FALSE}
cor_mat<-fish.df%>%
  select(calories,ends_with("_RDA"))%>%
  select(-fiber_RDA)%>%
  cor(use = "pairwise.complete.obs") #Almost all values of fiber_RDA equate to 0

p.mat<-cor_pmat(cor_mat)#pvalues

cor_tib<-cor_mat%>%
  as_tibble(rownames="variable")

#Variables with strong relationship with Avg sat score
strong_cor<-cor_tib%>%
  select(variable, calories)%>%
  filter(calories  < -0.25|calories >0.25)

```

```{r corr, include=TRUE, fig.height= 6, fig.width= 9, fig.align="center", message=FALSE, warning=FALSE, echo=FALSE }

#Plot matrix table to see strength of relationships
fig7 <- ggcorrplot(
  cor_mat, hc.order = TRUE, type = "lower", title = "Correlation: Calories and Fish Nutrients", outline.col = "white", p.mat = p.mat)+
  theme(plot.title = element_text(color="black", size=14, face="bold", hjust = 0.5))

fig7

```

<br></br>

<center>
####  How do fish calories compare to fat, saturated fatty acids, carbs and protein?
</center>

```{r fat.quad, echo=FALSE}
#fat

cal_mean<-mean(fish.df$calories, na.rm = TRUE)
f.per_mean<-mean(fish.df$fat_RDA, na.rm = TRUE)

fig8<-fish.df%>%
  mutate(quadrant = case_when(calories > cal_mean & fat_RDA > f.per_mean ~ "Q1",
                              calories <= cal_mean & fat_RDA > f.per_mean ~ "Q2",
                              calories <= cal_mean& fat_RDA <= f.per_mean ~ "Q3",
                              TRUE                                         ~ "Q4"))%>%
  ggplot(aes(x=calories, y=fat_RDA, color= quadrant, group=species)) +
  geom_point() +
  lims(x=c(50,250),y=c(1,20)) +
  theme_minimal()+
  theme(plot.title = element_text(color="black", size=14, face="bold",
                                          hjust = 0.5),
        axis.title.x = element_text(color="black", size=12),
        axis.title.y = element_text(color="black", size=12))+
  labs(title="Avg. Fish Fat vs Avg. Calories",
       x= "Calories",
       y= "Percentage RDA") +
  geom_vline(xintercept = cal_mean) + 
  geom_hline(yintercept = f.per_mean)+
  annotate("text", x=62, y=2, label= "Low calories \nLow nutrients", size=3) + 
  annotate("text", x =62, y=17, label = "Low calories \nHigh nutrients", size=3)+
  annotate("text", x=230, y=2, label= "High calories \nLow nutrients", size=3) + 
  annotate("text", x =230, y=17, label = "High calories \nHigh nutrients", size=3)

mrg3 <- list(l = 10, r = 10,
          b = 10, t = 100,
          pad = 0)

fig8<- ggplotly(fig8, tooltip = "species")%>%
  layout(margin=mrg3)
```

<center>
```{r fig8, echo=FALSE }

fig8
```
</center>

```{r s.quad, echo=FALSE }

#S.fat
cal_mean<-mean(fish.df$calories, na.rm = TRUE)
sf.per_mean<-mean(fish.df$s.fat_RDA, na.rm = TRUE)

fig9<-fish.df%>%
  mutate(quadrant = case_when(calories > cal_mean & s.fat_RDA > sf.per_mean ~ "Q1",
                              calories <= cal_mean & s.fat_RDA > sf.per_mean~ "Q2",
                              calories <= cal_mean & s.fat_RDA <= sf.per_mean ~ "Q3",
                              TRUE                            ~ "Q4"))%>%
  ggplot(aes(x=calories, y=s.fat_RDA, color= quadrant, group=species)) +
  geom_point() +
  lims(x=c(0,250),y=c(-1,20)) +
  theme_minimal()+
  theme(plot.title = element_text(color="black", size=14, face="bold",
                                          hjust = 0.5),
        axis.title.x = element_text(color="black", size=12),
        axis.title.y = element_text(color="black", size=12))+
  labs(title="Avg. Saturated Fatty Acids \nvs Avg. Calories",
       x= "Calories",
       y= "Percentage RDA") +
  geom_vline(xintercept = cal_mean) + 
  geom_hline(yintercept = sf.per_mean)+
  annotate("text", x=20, y=2, label= "Low calories \nLow nutrients", size=3) + 
  annotate("text", x =20, y=17, label = "Low calories \nHigh nutrients", size=3)+
  annotate("text", x=230, y=2, label= "High calories \nLow nutrients", size=3) + 
  annotate("text", x =230, y=17, label = "High calories \nHigh nutrients", size=3)

mrg3 <- list(l = 10, r = 10,
          b = 10, t = 100,
          pad = 0)

fig9<- ggplotly(fig9, tooltip = "species")%>%
  layout(margin=mrg3)
```

<center>
```{r fig9, echo=FALSE}

fig9
```
</center>

```{r carb.quad, echo=FALSE}

#carbs
cal_mean<-mean(fish.df$calories, na.rm = TRUE)
c.per_mean<-mean(fish.df$carbs_RDA, na.rm = TRUE)

fig10<-fish.df%>%
  mutate(quadrant = case_when(calories > cal_mean & carbs_RDA > c.per_mean ~ "Q1",
                              calories <= cal_mean & carbs_RDA > c.per_mean~ "Q2",
                              calories <= cal_mean & carbs_RDA <= c.per_mean ~ "Q3",
                              TRUE                            ~ "Q4"))%>%
  ggplot(aes(x=calories, y=carbs_RDA, color= quadrant, group=species)) +
  geom_point() +
  lims(x=c(25,250),y=c(-1,5)) +
  theme_minimal()+
  theme(plot.title = element_text(color="black", size=14, face="bold",
                                          hjust = 0.5),
        axis.title.x = element_text(color="black", size=12),
        axis.title.y = element_text(color="black", size=12))+
  labs(title="Avg. Carbohydrates \nvs Avg. Calories",
       x= "Calories",
       y= "Percentage RDA") +
  geom_vline(xintercept = cal_mean) + 
  geom_hline(yintercept = c.per_mean)+
  annotate("text", x=40, y=-0.5, label= "Low calories \nLow nutrients", size=3) + 
  annotate("text", x =40, y=3, label = "Low calories \nHigh nutrients", size=3)+
  annotate("text", x=230, y=-0.5, label= "High calories \nLow nutrients", size=3) + 
  annotate("text", x =230, y=3, label = "High calories \nHigh nutrients", size=3)

mrg3 <- list(l = 10, r = 10,
          b = 10, t = 100,
          pad = 0)

fig10<- ggplotly(fig10, tooltip = "species")%>%
  layout(margin=mrg3)
```

<center>
```{r fig10, echo=FALSE}

fig10
```
</center>

```{r p.quad, echo=FALSE}
#protein
cal_mean<-mean(fish.df$calories, na.rm = TRUE)
p.per_mean<-mean(fish.df$protein_RDA, na.rm = TRUE)

fig11<-fish.df%>%
  mutate(quadrant = case_when(calories > cal_mean & protein_RDA > p.per_mean ~ "Q1",
                              calories <= cal_mean & protein_RDA > p.per_mean~ "Q2",
                              calories <= cal_mean & protein_RDA <= p.per_mean ~ "Q3",
                              TRUE                            ~ "Q4"))%>%
  ggplot(aes(x=calories, y=protein_RDA, color= quadrant, group=species)) +
  geom_point() +
  lims(x=c(25,250),y=c(-1,80)) +
  theme_minimal()+
  theme(plot.title = element_text(color="black", size=14, face="bold",
                                          hjust = 0.5),
        axis.title.x = element_text(color="black", size=12),
        axis.title.y = element_text(color="black", size=12))+
  labs(title="Avg. Protein \nvs Avg. Calories",
       x= "Calories",
       y= "Percentage RDA") +
  geom_vline(xintercept = cal_mean) + 
  geom_hline(yintercept = p.per_mean)+
  annotate("text", x=35, y=17, label= "Low calories \nLow nutrients", size=3) + 
  annotate("text", x =35, y=65, label = "Low calories \nHigh nutrients", size=3)+
  annotate("text", x=230, y=17, label= "High calories \nLow nutrients", size=3) + 
  annotate("text", x =230, y=65, label = "High calories \nHigh nutrients", size=3)

mrg3 <- list(l = 10, r = 10,
          b = 10, t = 100,
          pad = 0)

fig11<- ggplotly(fig11, tooltip = "species")%>%
  layout(margin=mrg3)
```

<center>
```{r fig11, echo=FALSE}
fig11
```
</center>

Above graphs depict a **nutritional value quadrant** for the fish species found within the NOAA region. For all intents and purposes, the species found in **quadrant 1** in each graph have the best value for calories and their respective nutritional component.

As human diet differ across communities, some might be looking for different levels of nutrients. It is important to be aware of how calories relate to your diet of choice. Also to debunk any misguided information one might have had prior. 

<br></br>

